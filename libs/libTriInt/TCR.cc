/* Copyright (C) 2005-2011 M. T. Homer Reid
 *
 * This file is part of SCUFF-EM.
 *
 * SCUFF-EM is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * SCUFF-EM is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */

/*
 * TCR.cc -- 'triangle cubature rules' of various orders 
 *
 * the basic routine here is 
 * 
 *  double *GetTCR(int Order, int *NumPts);
 *
 * you call this routine with the Order parameter set 
 * equal to 1, 4, 5, 7, 9, 13, 14, 16, 20, or 25.
 *
 * on return, you get back a pointer to a vector of 
 * doubles describing a rule for integrating a function
 * over a triangle, and *NumPts is set equal to 
 * the number of points in the rule.
 *
 * the tables are laid out in the following order:
 *  u1 v1 w1 
 *  u2 v2 w2 
 *  ...
 *  uN vN wN
 *
 * where (uN,vN) are the coordinates of the Nth cubature point
 * (after mapping to the standard triangle) and wN is its weight.
 * (thus there are a total of 3*NumPts doubles in the table).
 *
 * if the vertices of a general triangle are (vectors) V0, V1, V2, 
 * then the cartesian coordinates of the Nth cubature point are 
 * 
 * xN = V0 + uN(V1-V0) + uN(V2-V0) 
 *
 * and the integral 
 *
 * I = \int_{triangle} f(x) d^2x 
 *
 * is approximated as the sum 
 *
 * I \approx 2A * \sum_n wN * f(xN)
 *
 * (where 2A is two times the area of the triangle, the jacobian  
 *  of the variable transformation from (x,y) to (u,v)           )
 * 
 * homer reid 3/2007 -- 6/2010
 * 
 */

#include <stdio.h>
#include <stdlib.h>

#include "libTriInt.h"

/* case 0:  TCR=TCR1;   NumPts=1;  break; */
static double TCR1[]=
{ 0.3333333333333, 0.3333333333333, 0.50000000000000
};

/* case 2:  TCR=TCR2;   NumPts=3;  break; */
static double TCR2[]=
{ 0.16666666666666666, 0.16666666666666666, 0.16666666666666666,
  0.66666666666666667, 0.16666666666666666, 0.16666666666666666,
  0.16666666666666666, 0.66666666666666666, 0.16666666666666666
};

/* case 4:  TCR=TCR4;   NumPts=6;  break; */
static double TCR4[]=
{ 
  0.0915762135098, 0.0915762135098, 0.0549758718276,
  0.8168475729805, 0.0915762135098, 0.0549758718276,
  0.0915762135098, 0.8168475729805, 0.0549758718276,
  0.1081030181681, 0.4459484909160, 0.1116907948390,
  0.4459484909160, 0.1081030181681, 0.1116907948390,
  0.4459484909160, 0.4459484909160, 0.1116907948390
};

#if 0 
 // old rule of order 5 
/* case 5:  TCR=TCR5;   NumPts=10;  break; */
static double TCR5[]=
{ 
  0.0000000000000, 1.0000000000000, 0.0065678024876,
  1.0000000000000, 0.0000000000000, 0.0065679153017,
  0.0000000000000, 0.0000000000000, 0.0068540986900,
  0.2673273531185, 0.6728199218710, 0.0587095966456,
  0.6728175529461, 0.2673288599482, 0.0587103059567,
  0.0649236350054, 0.6716530111494, 0.0620062948279,
  0.6716498539042, 0.0649251690029, 0.0620076230630,
  0.0654032456800, 0.2693789366453, 0.0629651151382,
  0.2693767069140, 0.0654054874919, 0.0629665133414,
  0.3386738503896, 0.3386799893027, 0.1126447345478
};
#endif

#if 0 
 //old rule of order 7
/* case 7:  TCR=TCR7;   NumPts=15;  break; */
static double TCR7[]=
{ 
  1.0000000000000, 0.0000000000000, 0.0025639543523,
  0.0000000000000, 0.0000000000000, 0.0025639543523,
  0.0000000000000, 1.0000000000000, 0.0025639543523,
  0.7839656651012, 0.0421382841642, 0.0279011761662,
  0.1738960507345, 0.7839656651012, 0.0279011761662,
  0.1738960507345, 0.0421382841642, 0.0279011761662,
  0.0421382841642, 0.1738960507345, 0.0279011761662,
  0.7839656651012, 0.1738960507345, 0.0279011761662,
  0.0421382841642, 0.7839656651012, 0.0279011761662,
  0.4743880861752, 0.4743880861752, 0.0419943898834,
  0.4743880861752, 0.0512238276497, 0.0419943898834,
  0.0512238276497, 0.4743880861752, 0.0419943898834,
  0.2385615300181, 0.5228769399639, 0.0663059700986,
  0.5228769399639, 0.2385615300181, 0.0663059700986,
  0.2385615300181, 0.2385615300181, 0.0663059700986
};
#endif

/***************************************************************/
/* NOTE: the following two rules comprise an embedded cubature */
/* rule of order 7/5. the cubature points for the 5th order    */
/* rule coincide with the first 7 points of the 7th order rule.*/
/***************************************************************/

/* case 5:  TCR=TCR5;   NumPts=7;  break; */
static double TCR5[]=
  {
    0.333333333333333, 0.333333333333333, 0.112500000000000,
    0.470142064105115, 0.470142064105115, 0.066197076394253,
    0.059715871789770, 0.470142064105115, 0.066197076394253,
    0.470142064105115, 0.059715871789770, 0.066197076394253,
    0.101286507323456, 0.101286507323456, 0.062969590272414,
    0.797426985353087, 0.101286507323456, 0.062969590272414,
    0.101286507323456, 0.797426985353087, 0.062969590272414
 }; 

/* case 7:  TCR=TCR7;   NumPts=16;  break; */
static double TCR7[]=
  {
    0.333333333333333, 0.333333333333333,  0.098939732142857,
    0.470142064105115, 0.470142064105115,  0.054720640654316,
    0.059715871789770, 0.470142064105115,  0.054720640654316,
    0.470142064105115, 0.059715871789770,  0.054720640654316,
    0.101286507323456, 0.101286507323456, -0.335978081130506,
    0.797426985353087, 0.101286507323456, -0.335978081130506,
    0.101286507323456, 0.797426985353087, -0.335978081130506,
    0.111111111111111, 0.111111111111111,  0.366127232142858,
    0.111111111111111, 0.777777777777777,  0.366127232142858,
    0.777777777777777, 0.111111111111111,  0.366127232142858,
    0.111111111111111, 0.874775927356380,  0.024408482142858,
    0.874775927356380, 0.111111111111111,  0.024408482142858,
    0.111111111111111, 0.014112961532509,  0.024408482142858,
    0.014112961532509, 0.111111111111111,  0.024408482142858, 
    0.874775927356380, 0.014112961532509,  0.024408482142858,
    0.014112961532509, 0.874775927356380,  0.024408482142858
 }; 

/* case 9:  TCR=TCR9;   NumPts=21; break; */
static double TCR9[]=
{ 
  0.0451890097844, 0.0451890097844, 0.0129967855161,
  0.0451890097844, 0.9096219804312, 0.0129967855161,
  0.9096219804312, 0.0451890097844, 0.0129967855161,
  0.7475124727339, 0.0304243617288, 0.0176758525446,
  0.2220631655373, 0.0304243617288, 0.0176758525446,
  0.7475124727339, 0.2220631655373, 0.0176758525446,
  0.2220631655373, 0.7475124727339, 0.0176758525446,
  0.0304243617288, 0.7475124727339, 0.0176758525446,
  0.0304243617288, 0.2220631655373, 0.0176758525446,
  0.1369912012649, 0.2182900709714, 0.0227347690238,
  0.6447187277637, 0.2182900709714, 0.0227347690238,
  0.1369912012649, 0.6447187277637, 0.0227347690238,
  0.2182900709714, 0.6447187277637, 0.0227347690238,
  0.2182900709714, 0.1369912012649, 0.0227347690238,
  0.6447187277637, 0.1369912012649, 0.0227347690238,
  0.0369603304334, 0.4815198347833, 0.0258086012845,
  0.4815198347833, 0.0369603304334, 0.0258086012845,
  0.4815198347833, 0.4815198347833, 0.0258086012845,
  0.4036039798179, 0.1927920403641, 0.0470400367292,
  0.4036039798179, 0.4036039798179, 0.0470400367292,
  0.1927920403641, 0.4036039798179, 0.0470400367292
};

/* case 13: TCR=TCR13;  NumPts=36; break; */
static double TCR13[]=
{ 
  0.0242935351590, 0.9493059293846, 0.0041560249689,
  0.0265193427722, 0.0242695130640, 0.0041702924944,
  0.9492126023551, 0.0265067966437, 0.0041707642267,
  0.0033775763749, 0.4767316412363, 0.0043920217521,
  0.4757672298101, 0.5198921829102, 0.0046118665461,
  0.5190783193471, 0.0055912706202, 0.0049485602547,
  0.8616839745321, 0.0133996048618, 0.0050885098964,
  0.1249209759926, 0.8613054321334, 0.0051713215985,
  0.0138565453861, 0.1247733717358, 0.0052067841521,
  0.0211887064222, 0.8438438351223, 0.0079454944570,
  0.8432296787219, 0.1354563645830, 0.0080118008810,
  0.1354231797865, 0.0213482820656, 0.0080151920286,
  0.3088853510679, 0.0221919663014, 0.0107691489796,
  0.6685057595169, 0.3089012879389, 0.0109618353835,
  0.0226545012557, 0.6691709943321, 0.0109802418183,
  0.2808515408772, 0.6924718155106, 0.0119987980923,
  0.6922446749051, 0.0268723345026, 0.0120951565183,
  0.0268617447119, 0.2810093973222, 0.0121216855844,
  0.1141778485470, 0.7973581413586, 0.0139241122006,
  0.7974807922061, 0.0879806508791, 0.0140256591089,
  0.0892807293894, 0.1145020561128, 0.0141297530923,
  0.1052487892455, 0.6686904119922, 0.0172322472667,
  0.6663022280740, 0.2275051631832, 0.0179303334022,
  0.2307803737547, 0.1054572561221, 0.0181863480244,
  0.1705059157540, 0.5174064398658, 0.0197201834184,
  0.5086593973043, 0.3170523855209, 0.0202528586378,
  0.3141823862281, 0.1810706361659, 0.0206431324764,
  0.4617460817864, 0.4678594539804, 0.0210511141833,
  0.0693087496081, 0.4622856042085, 0.0210896383326,
  0.4651955259268, 0.0724357805669, 0.0212992467122,
  0.2578625857893, 0.6131395039177, 0.0225711332013,
  0.6112627766779, 0.1300360834609, 0.0228570785871,
  0.1305182135934, 0.2581713828884, 0.0229069766352,
  0.4281437991828, 0.2362005969817, 0.0256393343724,
  0.3356995783730, 0.4311026308588, 0.0258289915353,
  0.2305424298836, 0.3456013949376, 0.0258963591798
};

/* case 14: TCR=TCR14;  NumPts=37; break; */
/* (note: this is actually a 13th order rule) */
static double TCR14[]=
{
  0.3333333333333, 0.3333333333333, 0.0258698830329,
  0.0248621685379, 0.0248621685379, 0.0040038997778,
  0.0248621685379, 0.9502756629241, 0.0040038997778,
  0.9502756629241, 0.0248621685379, 0.0040038997778,
  0.4141925425381, 0.4141925425381, 0.0234344494909,
  0.4141925425381, 0.1716149149238, 0.0234344494909,
  0.1716149149238, 0.4141925425381, 0.0234344494909,
  0.2302938781614, 0.2302938781614, 0.0232954700920,
  0.2302938781614, 0.5394122436772, 0.0232954700920,
  0.5394122436772, 0.2302938781614, 0.0232954700920,
  0.1139199816617, 0.1139199816617, 0.0155084716569,
  0.1139199816617, 0.7721600366765, 0.0155084716569,
  0.7721600366765, 0.1139199816617, 0.0155084716569,
  0.4954573000251, 0.4954573000251, 0.0053958063683,
  0.4954573000251, 0.0090853999498, 0.0053958063683,
  0.0090853999498, 0.4954573000251, 0.0053958063683,
  0.4688613548471, 0.4688613548471, 0.0160977671212,
  0.4688613548471, 0.0622772903059, 0.0160977671212,
  0.0622772903059, 0.4688613548471, 0.0160977671212,
  0.8513065041743, 0.1266172061720, 0.0077229171054,
  0.1266172061720, 0.0220762896536, 0.0077229171054,
  0.0220762896536, 0.8513065041743, 0.0077229171054,
  0.6894419707286, 0.2919375064689, 0.0089114949616,
  0.2919375064689, 0.0186205228025, 0.0089114949616,
  0.0186205228025, 0.6894419707286, 0.0089114949616,
  0.6358678594339, 0.2676256592740, 0.0185193418407,
  0.2676256592740, 0.0965064812922, 0.0185193418407,
  0.0965064812922, 0.6358678594339, 0.0185193418407,
  0.0220762896536, 0.1266172061720, 0.0077229171054,
  0.1266172061720, 0.8513065041743, 0.0077229171054,
  0.8513065041743, 0.0220762896536, 0.0077229171054,
  0.0186205228025, 0.2919375064689, 0.0089114949616,
  0.2919375064689, 0.6894419707286, 0.0089114949616,
  0.6894419707286, 0.0186205228025, 0.0089114949616,
  0.0965064812922, 0.2676256592740, 0.0185193418407,
  0.2676256592740, 0.6358678594339, 0.0185193418407,
  0.6358678594339, 0.0965064812922, 0.0185193418407
};


/* case 16: TCR=TCR16;  NumPts=55; break; */
static double TCR16[]=
{ 
  1.0000000000000, 0.0000000000000, 0.0001550649963,
  0.0000000000000, 1.0000000000000, 0.0001578793678,
  0.0000000000000, 0.0000000000000, 0.0001771650390,
  0.9398863583577, 0.0049848744634, 0.0013790929042,
  0.0543806683058, 0.9386405618617, 0.0015673101914,
  0.0093940049164, 0.0526424462697, 0.0019632852206,
  0.0164345086362, 0.9469035517351, 0.0023637870966,
  0.9469487269862, 0.0363373677167, 0.0024456127818,
  0.0426604005768, 0.0151224541799, 0.0024965410872,
  0.0122269495439, 0.8693773510664, 0.0034388454704,
  0.8673696521047, 0.1204917285774, 0.0035244794510,
  0.8456744021389, 0.0157763967870, 0.0037411716084,
  0.1395759632103, 0.8448120870375, 0.0039024375903,
  0.1317821743231, 0.0135009605584, 0.0039420923337,
  0.0157955126300, 0.1455274938536, 0.0043948636596,
  0.7365462884436, 0.0155697540908, 0.0051028460068,
  0.0139688430330, 0.7379836894450, 0.0052390719654,
  0.2547895186039, 0.7297615689771, 0.0052678353250,
  0.7316386522555, 0.2543076683315, 0.0054411690051,
  0.0157253728951, 0.2696239795791, 0.0055572102175,
  0.2662302843647, 0.0144783956308, 0.0056046673421,
  0.8673504065214, 0.0591679410400, 0.0057530654248,
  0.0741493666957, 0.8634782575061, 0.0059203475625,
  0.0159285948360, 0.4191238955238, 0.0064366160842,
  0.0156061028068, 0.5809222921146, 0.0064489200402,
  0.5910094817484, 0.0159251452651, 0.0064518081902,
  0.4034771496889, 0.5806700368104, 0.0065085808015,
  0.5694745628526, 0.4149495146302, 0.0066442035402,
  0.0678493700650, 0.0761218678591, 0.0066446190458,
  0.4265968590272, 0.0157509692312, 0.0066883082310,
  0.0670982507890, 0.7741898312421, 0.0093946951660,
  0.7528310231480, 0.0819119495639, 0.0095766473549,
  0.7753727783557, 0.1577128457292, 0.0096212423756,
  0.1689073157787, 0.7503943099742, 0.0097404956463,
  0.1687335832919, 0.0708311507268, 0.0098651027887,
  0.0821244708436, 0.1762996626771, 0.0103091194524,
  0.6288705363345, 0.0807744953317, 0.0128218109621,
  0.0811413015266, 0.3054373589776, 0.0129101410484,
  0.2969112065080, 0.6227485988871, 0.0129557510567,
  0.0767542314171, 0.6247247149546, 0.0132131997045,
  0.6223022333845, 0.3011485821166, 0.0134626393257,
  0.3103786288051, 0.0779098365079, 0.0135473832330,
  0.0819218215187, 0.4603633038351, 0.0146184286611,
  0.4717022665013, 0.0821554006797, 0.0148215792091,
  0.4546603415250, 0.4637565033890, 0.0148589569187,
  0.1701091339237, 0.6422277808188, 0.0157950063966,
  0.6406004329487, 0.1898293537256, 0.0158231711288,
  0.1912267583717, 0.1739955685343, 0.0160176840443,
  0.1885315767070, 0.4798914070406, 0.0203010148980,
  0.4772929957691, 0.3348356598119, 0.0203609378382,
  0.3126974621760, 0.4957972197259, 0.0203669800310,
  0.4961225945946, 0.1927553668904, 0.0203762637021,
  0.1928805312867, 0.3161015807261, 0.0203791166235,
  0.3360041453816, 0.1894892801290, 0.0204232764906,
  0.3337280550848, 0.3343571021811, 0.0230804583633
};


/* case 20: TCR=TCR20;  NumPts=78; break; */
static double TCR20[]=
{ 
  0.0089411337112, 0.0086983293702, 0.0005436136350,
  0.9792622629807, 0.0102644133744, 0.0007246783816,
  0.0105475382112, 0.9785514202515, 0.0007711507334,
  0.0023777061947, 0.0636551098604, 0.0008600408276,
  0.0630425115795, 0.0041506347509, 0.0010474618003,
  0.9308422496730, 0.0048053482263, 0.0011184512874,
  0.0629076555490, 0.9316790069481, 0.0011763605204,
  0.9315962246381, 0.0626264881801, 0.0012216983938,
  0.0061951689415, 0.9293587058564, 0.0012981910842,
  0.0287125819237, 0.0310202122997, 0.0018518264745,
  0.9293844478305, 0.0342152968219, 0.0019938852575,
  0.0375457566621, 0.9257868884669, 0.0020887630728,
  0.0086895739064, 0.1584971251510, 0.0024041665216,
  0.1547597053965, 0.8363606657688, 0.0024079564462,
  0.8331025294185, 0.0089257244824, 0.0024644365190,
  0.8374231073526, 0.1529167304078, 0.0025664470075,
  0.1559362505234, 0.0094966240058, 0.0025797025778,
  0.0098599642095, 0.8342211493596, 0.0026572750407,
  0.4055873733289, 0.0074389302008, 0.0026720326724,
  0.5964727898618, 0.3956330809311, 0.0026742255252,
  0.0080747800416, 0.4031319425903, 0.0027256615429,
  0.0075073977721, 0.5851609594681, 0.0027474945894,
  0.3936764519237, 0.5974896592899, 0.0028355763807,
  0.5846530726212, 0.0087250464968, 0.0030133910733,
  0.4870804112120, 0.0202129229912, 0.0034904798455,
  0.2683512811785, 0.7202340088668, 0.0035286997884,
  0.7223956288748, 0.2662399366456, 0.0035482586762,
  0.2716826742357, 0.0112882698808, 0.0036053169067,
  0.0112580842046, 0.7169695963325, 0.0036176086714,
  0.0115034734370, 0.2740067110166, 0.0036237442468,
  0.7140525900564, 0.0113511560497, 0.0036346693923,
  0.4902871053112, 0.4936491841468, 0.0036491047731,
  0.0201423425209, 0.4832573459601, 0.0036828644617,
  0.0361107464859, 0.0935679501582, 0.0041865990826,
  0.8607998819851, 0.0397379067075, 0.0042238875115,
  0.1005891526001, 0.8586343419352, 0.0042355665721,
  0.0918740717058, 0.0395513001973, 0.0043267543024,
  0.8604888296191, 0.0966224057079, 0.0043631136623,
  0.0439842178673, 0.8561886349107, 0.0044304305540,
  0.2011017606735, 0.7449115835626, 0.0070706006006,
  0.7449993726263, 0.0536865638166, 0.0071249178122,
  0.0532186641310, 0.1963754275935, 0.0071251411635,
  0.7453984647401, 0.1982065805550, 0.0075161805869,
  0.1957289932876, 0.0555713833156, 0.0075507819270,
  0.1092532057988, 0.6100036182413, 0.0075996784019,
  0.0567625702001, 0.7409121894959, 0.0076417199019,
  0.0483837933475, 0.6075135660978, 0.0076516853251,
  0.1080612809760, 0.1122081510437, 0.0077332517050,
  0.6185605900991, 0.2698753703035, 0.0077443455209,
  0.7721296013497, 0.1114117395333, 0.0078286562636,
  0.6115734801133, 0.3389367677931, 0.0078393373348,
  0.3381326103376, 0.0494693938787, 0.0078580117322,
  0.1173084128254, 0.7696451309795, 0.0078795535974,
  0.2674551260596, 0.1115718808154, 0.0081062034496,
  0.6542100160026, 0.1906548314700, 0.0086878038097,
  0.0538297481158, 0.3358616826849, 0.0087598363732,
  0.1848840324117, 0.1551831523851, 0.0087679355077,
  0.3376267104744, 0.6081402596294, 0.0088032303833,
  0.6067102034499, 0.0542632795598, 0.0088153876245,
  0.4612614085496, 0.0688176670722, 0.0091600805086,
  0.1525465365671, 0.6510240845749, 0.0091933276918,
  0.0700582543543, 0.4661904392742, 0.0092918915734,
  0.4704201379032, 0.4634826455353, 0.0093342892902,
  0.1216461693746, 0.2381494875516, 0.0100993336647,
  0.6371404052702, 0.1238399384513, 0.0103395010159,
  0.2379904515119, 0.6370216452326, 0.0105489447968,
  0.1483929857177, 0.4894188577780, 0.0123862751009,
  0.3598069571550, 0.1452880866253, 0.0125104815285,
  0.4941441055095, 0.3610216383818, 0.0126448646779,
  0.1440630687981, 0.3513508341887, 0.0130009302547,
  0.5019764440004, 0.1435491663293, 0.0130383391972,
  0.3555423834298, 0.5016491599502, 0.0131224788090,
  0.2443439540771, 0.2406052129104, 0.0149789940629,
  0.2437064989342, 0.5109017277055, 0.0149902499357,
  0.5122200807321, 0.2452737973543, 0.0149978818032,
  0.2526038315178, 0.3700319555094, 0.0158533295862,
  0.3759895652851, 0.2505406611631, 0.0158827965277,
  0.3729077987144, 0.3753750277549, 0.0159301651418
};

/* case 25: TCR=TCR25;  NumPts=120; break; */
static double TCR25[]=
{ 
  0.0082881595033, 0.9848202768869, 0.0003718354465,
  0.4618422030241, 0.5381577969759, 0.0003722258815,
  0.0071066441239, 0.0080842361390, 0.0003751486095,
  0.9847613141699, 0.0070015755134, 0.0003764802078,
  0.5374447869049, 0.4625552130951, 0.0003829717179,
  0.0000000000000, 0.4887676880140, 0.0005758158622,
  0.4914131929361, 0.0000000000000, 0.0005912266760,
  0.0070345937020, 0.9574158053697, 0.0007187785903,
  0.9564734714228, 0.0364655449485, 0.0007465622184,
  0.0370198792045, 0.0070908577166, 0.0007596040684,
  0.1024124542747, 0.8936125594937, 0.0008023114922,
  0.5928065811509, 0.0049451705600, 0.0009257399609,
  0.0050948422371, 0.0996676659189, 0.0009351796509,
  0.0081562023689, 0.0415561148784, 0.0009613135806,
  0.0424936107568, 0.9494865260352, 0.0009667694667,
  0.9495543500844, 0.0081794507292, 0.0009798138794,
  0.8932787471239, 0.0053224326262, 0.0009893320672,
  0.0069317612927, 0.9065401020433, 0.0011008062931,
  0.9035839030665, 0.0894771171077, 0.0011476777043,
  0.0905665738209, 0.0070525342005, 0.0011755917359,
  0.0083929332787, 0.6663179931111, 0.0012503710955,
  0.6261245686071, 0.0092197583153, 0.0013096957539,
  0.0062801592979, 0.8335207460527, 0.0013605526023,
  0.8272539257367, 0.1665134939330, 0.0014232812228,
  0.0062005875353, 0.7424693255229, 0.0014776855747,
  0.1676900311185, 0.0065717743528, 0.0014921991922,
  0.7199353069567, 0.0064354534962, 0.0016815547572,
  0.2749740090237, 0.7185296120719, 0.0017076962156,
  0.0079257582005, 0.1766411374714, 0.0017382814778,
  0.0069981220752, 0.2704767254004, 0.0018115067660,
  0.8125248773263, 0.0082299533210, 0.0018182047403,
  0.0073536969970, 0.5934167875453, 0.0018252232712,
  0.7283665935411, 0.2648817553752, 0.0018401166694,
  0.1800642304565, 0.8115848976682, 0.0018529980814,
  0.2658102467762, 0.0068553525429, 0.0018723053584,
  0.0070892364520, 0.3757632659744, 0.0019651016815,
  0.3774054302043, 0.6148573533757, 0.0019655431606,
  0.0369649608668, 0.9210792302893, 0.0020126590266,
  0.9203194109805, 0.0426025082114, 0.0020360715118,
  0.0425477806431, 0.0372689941794, 0.0020369701038,
  0.6191278394983, 0.3724055713809, 0.0023111036653,
  0.3762697209178, 0.0081436422011, 0.0023668658791,
  0.0956111149690, 0.8771098372601, 0.0024283052534,
  0.0302473410377, 0.0943858903393, 0.0024938395288,
  0.8739905691754, 0.0313198990883, 0.0025841950918,
  0.8604133734958, 0.1049019782046, 0.0028065819291,
  0.0347307852352, 0.8609856462886, 0.0028577279686,
  0.1043606608343, 0.0357152881004, 0.0028887641872,
  0.7797622824754, 0.1872318199265, 0.0033893964239,
  0.0185865164256, 0.4834397678794, 0.0033996240725,
  0.0324585286618, 0.7783474916042, 0.0034438703459,
  0.8371293901157, 0.0804060570156, 0.0034490253985,
  0.0836602075315, 0.8421414817051, 0.0034602209976,
  0.0784070242501, 0.0849927089145, 0.0035158504994,
  0.4929238648458, 0.4892855914710, 0.0035247862752,
  0.1870637584073, 0.0345210858281, 0.0035501027998,
  0.4892636967025, 0.0190774755077, 0.0036129606129,
  0.0401982618372, 0.1691143187109, 0.0037561494910,
  0.7894259278865, 0.0412206731484, 0.0038204451030,
  0.1686260456429, 0.7894860640585, 0.0038887681042,
  0.3750901913174, 0.5895318272013, 0.0041142721500,
  0.0356362876880, 0.3681256217699, 0.0041318939893,
  0.5887548164804, 0.0359968962541, 0.0041711888613,
  0.0373308082182, 0.6790704673533, 0.0041852328246,
  0.2820769993374, 0.0373639992361, 0.0042168665840,
  0.6819277603320, 0.2803330345725, 0.0042220557541,
  0.0374938324382, 0.2634016180014, 0.0043021778173,
  0.6984079204127, 0.0364154673322, 0.0043670267066,
  0.2654390894079, 0.6980717436193, 0.0044165974903,
  0.1429848440800, 0.7612254618453, 0.0045741905369,
  0.7623554007647, 0.0943741220275, 0.0045894213115,
  0.0934222022749, 0.1479799836832, 0.0046598142380,
  0.5759004479923, 0.3821329641698, 0.0047445265148,
  0.3822427332525, 0.0426716362301, 0.0047961980644,
  0.0411414081675, 0.5718082874432, 0.0048520110511,
  0.0802462538379, 0.7702204382042, 0.0048680018048,
  0.7625229819410, 0.1559420577362, 0.0050213770124,
  0.1524941445131, 0.0842965421322, 0.0050418477333,
  0.0622159195833, 0.4538181318873, 0.0055435540690,
  0.1109539036076, 0.4586014071171, 0.0057425610127,
  0.4575627212057, 0.4795313560210, 0.0058366279350,
  0.4322865136374, 0.1230591237472, 0.0058720783835,
  0.5865002850241, 0.0834119779793, 0.0060170524754,
  0.0869359250818, 0.6755677013351, 0.0060227698238,
  0.0929594906936, 0.2326500892727, 0.0061419262370,
  0.6661932141454, 0.2448294007406, 0.0061634078930,
  0.4780306362227, 0.0661749044835, 0.0061689132513,
  0.4372215294577, 0.4442145585244, 0.0062426150678,
  0.6779224504669, 0.0929096534577, 0.0062506636021,
  0.2423431255660, 0.0889793655129, 0.0062622717356,
  0.2288925420305, 0.6780053081672, 0.0062734062531,
  0.3315065049959, 0.5847381559741, 0.0062870519057,
  0.3424200526607, 0.5139245722736, 0.0063752572612,
  0.0862630046475, 0.3340976249234, 0.0064136127995,
  0.5113188946635, 0.1380154720554, 0.0064493687658,
  0.1538977841001, 0.6788062619562, 0.0067501938498,
  0.6779951348472, 0.1663358925269, 0.0068607884211,
  0.1664600469411, 0.1582214504849, 0.0069268100372,
  0.0950910318888, 0.5666590332543, 0.0069571103841,
  0.3436048136712, 0.0978960873457, 0.0071801845276,
  0.5560417025366, 0.3468917820947, 0.0072206708739,
  0.1452404029513, 0.3599534491052, 0.0073325682440,
  0.1619685156238, 0.5810131373330, 0.0079725719889,
  0.5800164844262, 0.2560674640672, 0.0079770915071,
  0.2450201223288, 0.5881469552102, 0.0080234740082,
  0.2557621891794, 0.1652244065047, 0.0080404652195,
  0.2205239985511, 0.3496507466106, 0.0080606031884,
  0.4940183111285, 0.2549448448453, 0.0081768111605,
  0.2531570689798, 0.2543369115017, 0.0082486579174,
  0.5846891116357, 0.1666603916479, 0.0082957024006,
  0.1660333602278, 0.2523240191705, 0.0083714290663,
  0.2505426292461, 0.4959007627528, 0.0083867118198,
  0.3519336802182, 0.1805380367800, 0.0084262260747,
  0.3502668835419, 0.4358582329881, 0.0085090365692,
  0.4400892485512, 0.2120576104941, 0.0085616308831,
  0.4680855471546, 0.3552681570774, 0.0086382204313,
  0.1770237763947, 0.4670352922266, 0.0089195718926,
  0.3900920779501, 0.3323152819300, 0.0091164056254,
  0.2805847774120, 0.3898041176680, 0.0091293177176,
  0.3361523347440, 0.2778500044356, 0.0092981202754
};

/***************************************************************/
/* return a triangle cubature rule for the specified order     */
/***************************************************************/
double *GetTCR(int Order, int *NumPts)
{ 
  switch(Order)
   { 
     case 1:  *NumPts=1;   return TCR1;
     case 2:  *NumPts=3;   return TCR2;
     case 4:  *NumPts=6;   return TCR4;
     case 5:  *NumPts=7;   return TCR5;  
     case 7:  *NumPts=16;  return TCR7;
     case 9:  *NumPts=21;  return TCR9;
     case 13: *NumPts=36;  return TCR13;
     case 14: *NumPts=37;  return TCR14;
     case 16: *NumPts=55;  return TCR16;
     case 20: *NumPts=78;  return TCR20;
     case 25: *NumPts=120; return TCR25;
     default: 
      { fprintf(stderr,"libTriInt: unsupported order %i (aborting)\n", Order);
        exit(1);
      };
   };
}
